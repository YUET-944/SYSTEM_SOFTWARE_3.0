<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Business System API</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .nav-button { background: #007bff; color: white; padding: 8px 16px; text-decoration: none; border-radius: 4px; margin: 5px; display: inline-block; }
        .nav-button:hover { background: #0056b3; }
        .back-button { background: #6c757d; }
        .back-button:hover { background: #545b62; }
        .response { background: #f8f9fa; padding: 15px; border-radius: 4px; margin: 10px 0; }
        .current { background: #e9ecef; padding: 10px; border-radius: 4px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Universal Business System API</h1>
    <div id="content">
        <p>Loading...</p>
    </div>

    <script>
        let currentPath = window.location.pathname;
        
        async function loadEndpoint(path) {
            try {
                const response = await fetch(path);
                const data = await response.json();
                displayResponse(data);
                currentPath = path;
                updateURL(path);
            } catch (error) {
                document.getElementById('content').innerHTML = `<div class="response">Error: ${error.message}</div>`;
            }
        }

        function displayResponse(data) {
            let html = '<div class="response">';
            
            if (data.message) {
                html += `<h2>${data.message}</h2>`;
            }
            
            if (data.data) {
                html += '<h3>Data:</h3><pre>' + JSON.stringify(data.data, null, 2) + '</pre>';
            }
            
            if (data.navigation) {
                html += '<div class="nav-section">';
                
                if (data.navigation.back) {
                    html += `<a href="#" onclick="loadEndpoint('${data.navigation.back.url}')" class="nav-button back-button">${data.navigation.back.text}</a><br><br>`;
                }
                
                if (data.navigation.current) {
                    html += `<div class="current">Current: ${data.navigation.current}</div>`;
                }
                
                if (data.navigation.endpoints) {
                    html += '<h3>Available Endpoints:</h3>';
                    data.navigation.endpoints.forEach(endpoint => {
                        html += `<a href="#" onclick="loadEndpoint('${endpoint.url}')" class="nav-button">${endpoint.text} (${endpoint.method})</a> `;
                    });
                }
                
                if (data.navigation.actions) {
                    html += '<h3>Actions:</h3>';
                    data.navigation.actions.forEach(action => {
                        html += `<a href="#" onclick="loadEndpoint('${action.url}')" class="nav-button">${action.text} (${action.method})</a> `;
                    });
                }
                
                html += '</div>';
            }
            
            html += '</div>';
            document.getElementById('content').innerHTML = html;
        }

        function updateURL(path) {
            if (path !== window.location.pathname) {
                history.pushState({path: path}, '', path);
            }
        }

        // Handle browser back/forward buttons
        window.addEventListener('popstate', function(event) {
            if (event.state && event.state.path) {
                loadEndpoint(event.state.path);
            }
        });

        // Load initial page
        if (currentPath === '/' || currentPath === '') {
            loadEndpoint('/');
        } else {
            loadEndpoint(currentPath);
        }
    </script>
</body>
</html>
